
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://fantastic-admin.gitee.io
 * Github https://fantastic-admin.github.io
 */
  
import{d as pe,c as fe,a as he,y as ve,a2 as _e,F as ge,z as be,X as me,Y as ye,r as k,a3 as ke,G as Se,C as X,B as we,P,H as S,a1 as Y,a4 as Z,e as N,o as f,f as v,h as _,n as U,i as s,g as r,w as c,m as g,t as h,V as Q,O as x,l as $,W as ee,Z as te,J as ae,_ as Te,L as Ce,q as Re}from"./index-b8c7047d.js";const ze={class:"container"},Ve={key:0,class:"switch-type"},Be={key:1,class:"tips"},Ie={key:0,class:"tip"},Le={class:"tip"},xe={class:"tip"},He={key:1,class:"tip"},Ee=["onClick","onMouseover"],Me={class:"info"},De={class:"title"},Ne={class:"breadcrumb"},Ue={class:"path"},$e=pe({name:"Search",__name:"index",setup(Fe){const{t:w}=fe(),ne=he(),d=ve(),se=_e(),le=ge(),oe=be(),H=me(ye,Function,!0),b=k(!1),E=k(),T=k(""),V=k([]),i=k(-1),F=k(),m=k(),B=k([]);function re(t){return B.value.push(t)}ke(()=>{B.value=[]});const z=Se(()=>{let t=[];return t=V.value.filter(e=>{let o=!1;return H(e.i18n,e.title).toString().includes(T.value)&&(o=!0),e.path.includes(T.value)&&(o=!0),e.breadcrumb.some(n=>H(n.i18n,n.title).toString().includes(T.value))&&(o=!0),o}),t});X(()=>b.value,t=>{t?(document.body.classList.add("overflow-hidden"),m.value&&(m.value.scrollTop=0),S("up",K),S("down",O),S("enter",j),setTimeout(()=>{F.value.focus()},500)):(document.body.classList.remove("overflow-hidden"),S.unbind("up",K),S.unbind("down",O),S.unbind("enter",j),setTimeout(()=>{T.value="",i.value=-1},500))}),X(()=>z.value,()=>{i.value=-1,J()}),we(()=>{P.on("global-search-toggle",t=>{b.value||M(t),b.value=!b.value}),S("alt+s",t=>{d.settings.navSearch.enable&&d.settings.navSearch.enableHotkeys&&(t.preventDefault(),M(),b.value=!0)}),S("esc",t=>{d.settings.navSearch.enable&&d.settings.navSearch.enableHotkeys&&(t.preventDefault(),b.value=!1)}),M()});function ie(t){F.value.focus(),M(t)}function M(t="menu"){switch(E.value=t,V.value=[],t){case"menu":d.settings.app.routeBaseOn!=="filesystem"?se.routes.forEach(e=>{e.children&&q(e.children)}):le.menus.forEach(e=>{A(e.children)});break;case"tab":ce(oe.list);break}}function ue(t){var o;let e=!0;return(o=t.children)!=null&&o.every(n=>{var a;return((a=n.meta)==null?void 0:a.sidebar)===!1})&&(e=!1),e}function q(t,e,o,n){t.forEach(a=>{var C,u,l,y,p,R,I,L,G,W;if(((C=a.meta)==null?void 0:C.sidebar)!==!1){const D=Y(n)||[];a.children&&ue(a)?(D.push({title:(u=a.meta)==null?void 0:u.title,i18n:(l=a.meta)==null?void 0:l.i18n}),q(a.children,Z(e,a.path),((y=a.meta)==null?void 0:y.icon)??o,D)):(D.push({title:(p=a.meta)==null?void 0:p.title,i18n:(R=a.meta)==null?void 0:R.i18n}),V.value.push({path:Z(e,a.path),icon:((I=a.meta)==null?void 0:I.icon)??o,title:(L=a.meta)==null?void 0:L.title,i18n:(G=a.meta)==null?void 0:G.i18n,link:(W=a.meta)==null?void 0:W.link,breadcrumb:D}))}})}function A(t,e,o){t.forEach(n=>{var C,u,l,y,p,R,I,L;const a=Y(o)||[];n.children&&n.children.length>0?(a.push({title:(C=n.meta)==null?void 0:C.title,i18n:(u=n.meta)==null?void 0:u.i18n}),A(n.children,((l=n.meta)==null?void 0:l.icon)??e,a)):(a.push({title:(y=n.meta)==null?void 0:y.title,i18n:(p=n.meta)==null?void 0:p.i18n}),V.value.push({icon:((R=n.meta)==null?void 0:R.icon)??e,title:(I=n.meta)==null?void 0:I.title,path:n.path,i18n:(L=n.meta)==null?void 0:L.i18n,breadcrumb:a}))})}function ce(t){t.forEach(e=>{V.value.push({icon:e.icon,title:e.title,path:e.fullPath,i18n:e.i18n,breadcrumb:[]})})}function K(){z.value.length&&(i.value-=1,i.value<0&&(i.value=z.value.length-1),J())}function O(){z.value.length&&(i.value+=1,i.value>z.value.length-1&&(i.value=0),J())}function j(){i.value!==-1&&B.value[i.value].click()}function J(){if(m.value){let t=0;if(i.value!==-1){t=m.value.scrollTop;const e=B.value[i.value].offsetTop,o=B.value[i.value].clientHeight,n=m.value.scrollTop,a=m.value.clientHeight;e+o>n+a?t=e+o-a:e<=n&&(t=e)}m.value.scrollTo({top:t})}}function de(t,e){e?window.open(e,"_blank"):ne.push(t)}return(t,e)=>{const o=N("el-radio-button"),n=N("el-radio-group"),a=Te,C=N("el-input"),u=N("el-tag");return f(),v("div",{id:"search",class:ae({searching:s(b)}),onClick:e[4]||(e[4]=l=>s(b)&&s(P).emit("global-search-toggle"))},[_("div",ze,[_("div",{class:"search-box",onClick:e[3]||(e[3]=U(()=>{},["stop"]))},[s(d).settings.tabbar.enable?(f(),v("div",Ve,[r(n,{modelValue:s(E),"onUpdate:modelValue":e[0]||(e[0]=l=>Q(E)?E.value=l:null),size:"large",onChange:ie},{default:c(()=>[r(o,{label:"menu"},{default:c(()=>[g(h(s(w)("app.search.type.menu")),1)]),_:1}),r(o,{label:"tab"},{default:c(()=>[g(h(s(w)("app.search.type.tab")),1)]),_:1})]),_:1},8,["modelValue"])])):x("",!0),r(C,{ref_key:"searchInputRef",ref:F,modelValue:s(T),"onUpdate:modelValue":e[1]||(e[1]=l=>Q(T)?T.value=l:null),placeholder:s(w)("app.search.input"),clearable:"",onKeydown:[e[2]||(e[2]=$(l=>s(P).emit("global-search-toggle"),["esc"])),$(U(K,["prevent"]),["up"]),$(U(O,["prevent"]),["down"]),$(U(j,["prevent"]),["enter"])]},{prefix:c(()=>[r(a,{name:"ep:search"})]),_:1},8,["modelValue","placeholder","onKeydown"]),s(d).mode==="pc"?(f(),v("div",Be,[s(d).settings.navSearch.enableHotkeys?(f(),v("div",Ie,[r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(d).os==="mac"?"⌥":"Alt")+" + S ",1)]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.alt_s")),1)]),_:1})])):x("",!0),_("div",Le,[r(u,{type:"info",size:"large"},{default:c(()=>[r(a,{name:"ant-design:caret-up-filled"})]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[r(a,{name:"ant-design:caret-down-filled"})]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.up_down")),1)]),_:1})]),_("div",xe,[r(u,{type:"info",size:"large"},{default:c(()=>[r(a,{name:"ion:md-return-left"})]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.enter")),1)]),_:1})]),s(d).settings.navSearch.enableHotkeys?(f(),v("div",He,[r(u,{type:"info",size:"large"},{default:c(()=>[g(" ESC ")]),_:1}),r(u,{type:"info",size:"large"},{default:c(()=>[g(h(s(w)("app.search.esc")),1)]),_:1})])):x("",!0)])):x("",!0)]),_("div",{ref_key:"searchResultRef",ref:m,class:"result"},[(f(!0),v(ee,null,te(s(z),(l,y)=>(f(),v("a",{ref_for:!0,ref:re,key:l.path,class:ae(["item",{actived:y===s(i)}]),onClick:p=>de(l.path,l.link),onMouseover:p=>i.value=y},[l.icon?(f(),Ce(a,{key:0,name:l.icon,class:"icon"},null,8,["name"])):x("",!0),_("div",Me,[_("div",De,h(s(H)(l.i18n,l.title)),1),_("div",Ne,[(f(!0),v(ee,null,te(l.breadcrumb,(p,R)=>(f(),v("span",{key:R},[g(h(s(H)(p.i18n,p.title))+" ",1),r(a,{name:"ep:arrow-right"})]))),128))]),_("div",Ue,h(l.path),1)])],42,Ee))),128))],512)])],2)}}});const Oe=Re($e,[["__scopeId","data-v-ca891ac8"]]);export{Oe as default};
